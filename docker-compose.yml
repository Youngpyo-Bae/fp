version: '3'
services:
    web:
        build: apache
        image: pianos_web
        
        volumes:
            - ./apache/libs:/usr/share/php
            - ./apache/src:/var/www/html
            - ./apache/cdn:/var/www/html/cdn
        
        restart: on-failure
        
        ports:
            - 80:80
    
    db:
        build: postgres
        image: pianos_db
        
        env_file:
            - .env
        
        volumes:
            - ./postgres/pgdata:/var/lib/postgresql/data/pgdata
        
        restart: on-failure

